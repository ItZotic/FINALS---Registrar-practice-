#include<iostream>
#include<fstream>
using namespace std;

struct Person {
    string name;
    string password;
    string dateOfBirth;
    string address;
    string civilStatus;
    string fatherName;
    string motherMaidenName;
    int income; // in PHP (Philippine Peso)
};

int main()
{
    string command;
    while (true)
    {
        cout << "(register/exit/login)" << endl
             << "Command: ";
        getline(cin, command);

        if (command == "exit")
        {
            return 1;
        }
        else if (command == "register")
        {
            ofstream outFile("registration.txt", ios::app); // Append mode to add new registrations

            if (!outFile.is_open())
            {
                cout << "Could not open file." << endl;
                return 0;
            }

            Person newPerson;

            cout << "\nRegistration Form:" << endl;
            cout << "Name: ";
            getline(cin, newPerson.name);

            cout << "Password: ";
            getline(cin, newPerson.password);

            cout << "Date of Birth: ";
            getline(cin, newPerson.dateOfBirth);

            cout << "Address: ";
            getline(cin, newPerson.address);

            cout << "Civil Status (Single/Married/Divorced/Widowed): ";
            getline(cin, newPerson.civilStatus);

            cout << "Name of Father: ";
            getline(cin, newPerson.fatherName);

            cout << "Name of Mother (Maiden Name): ";
            getline(cin, newPerson.motherMaidenName);

            cout << "Monthly Income Range:" << endl;
            cout << "1. Below PHP 10,000" << endl;
            cout << "2. PHP 10,000 - PHP 20,000" << endl;
            cout << "3. Above PHP 20,000" << endl;
            cout << "Select an option (1/2/3): ";
            int incomeOption;
            cin >> incomeOption;
            cin.ignore(); // Ignore newline left in buffer after cin

            switch (incomeOption) {
                case 1:
                    newPerson.income = 10000; // Below PHP 10,000
                    break;
                case 2:
                    newPerson.income = 15000; // PHP 10,000 - PHP 20,000 (average)
                    break;
                case 3:
                    newPerson.income = 25000; // Above PHP 20,000
                    break;
                default:
                    newPerson.income = 0; // Default to 0 if invalid option
                    break;
            }

            outFile << newPerson.name << ","
                    << newPerson.password << ","
                    << newPerson.dateOfBirth << ","
                    << newPerson.address << ","
                    << newPerson.civilStatus << ","
                    << newPerson.fatherName << ","
                    << newPerson.motherMaidenName << ","
                    << newPerson.income << endl;

            outFile.close();

            cout << "\nRegistration successful." << endl;
        }
        else if (command == "login")
        {
            ifstream inFile("registration.txt");

            if (!inFile.is_open())
            {
                cout << "File not found or could not be opened." << endl;
                return 0;
            }

            string name, password, dateOfBirth, address, civilStatus, fatherName, motherMaidenName;
            int income;

            cout << "\nLogin:" << endl;
            cout << "Enter Username: ";
            getline(cin, name);

            cout << "Enter Password: ";
            getline(cin, password);

            bool found = false;

            while (getline(inFile, name, ','))
            {
                getline(inFile, password, ',');
                getline(inFile, dateOfBirth, ',');
                getline(inFile, address, ',');
                getline(inFile, civilStatus, ',');
                getline(inFile, fatherName, ',');
                getline(inFile, motherMaidenName, ',');
                inFile >> income;
                inFile.ignore(); // Ignore newline left in buffer after reading income

                if (name == name && password == password)
                {
                    found = true;
                    break;
                }
            }

            inFile.close();

            if (found)
            {
                cout << "Login successful." << endl;
                cout << "Welcome, " << name << endl;
                cout << "Date of Birth: " << dateOfBirth << endl;
                cout << "Address: " << address << endl;
                cout << "Civil Status: " << civilStatus << endl;
                cout << "Father's Name: " << fatherName << endl;
                cout << "Mother's Maiden Name: " << motherMaidenName << endl;
                cout << "Monthly Income: PHP " << income << endl;
            }
            else
            {
                cout << "Incorrect username or password." << endl;
            }
        }
        else
        {
            cout << "Invalid command. Please try again." << endl;
        }

        cout << "\n\n\n\n\n"; // Give it 5 newlines for clarity
    }

    return 1;
}
